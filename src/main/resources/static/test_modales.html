<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Modales</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <style>
        body {
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .test-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .btn-test {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-test.success {
            background: linear-gradient(135deg, #51cf66 0%, #37b24d 100%);
            color: white;
        }
        .btn-test.error {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }
        .btn-test.warning {
            background: linear-gradient(135deg, #ffd43b 0%, #fab005 100%);
            color: #333;
        }
        .btn-test.info {
            background: linear-gradient(135deg, #4dabf7 0%, #228be6 100%);
            color: white;
        }
        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .result {
            margin-top: 15px;
            padding: 10px;
            background: white;
            border-radius: 4px;
            font-size: 14px;
            color: #495057;
        }
    </style>
</head>
<body>

<div class="test-container">
    <h1>üß™ Prueba del Sistema de Modales</h1>

    <div class="test-section">
        <h2>üì¢ Notificaciones Simples</h2>
        <p style="color: #666; margin-bottom: 10px;">Modales con un solo bot√≥n "Aceptar"</p>
        <button class="btn-test success" onclick="testSuccess()">‚úì √âxito</button>
        <button class="btn-test error" onclick="testError()">‚úï Error</button>
        <button class="btn-test warning" onclick="testWarning()">‚ö† Advertencia</button>
        <button class="btn-test info" onclick="testInfo()">‚Ñπ Informaci√≥n</button>
    </div>

    <div class="test-section">
        <h2>‚ùì Confirmaciones</h2>
        <p style="color: #666; margin-bottom: 10px;">Modales con dos botones "Confirmar" y "Cancelar"</p>
        <button class="btn-test warning" onclick="testConfirm()">Eliminar Alumno</button>
        <button class="btn-test warning" onclick="testConfirmCurso()">Eliminar Curso</button>
        <div id="confirmResult" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>üîÑ Simulaci√≥n de Operaciones</h2>
        <p style="color: #666; margin-bottom: 10px;">Prueba de flujo completo con confirmaci√≥n + resultado</p>
        <button class="btn-test info" onclick="testOperacionCompleta()">Guardar Datos</button>
        <button class="btn-test error" onclick="testOperacionError()">Operaci√≥n con Error</button>
    </div>

    <div class="test-section">
        <h2>üìù Estado Actual</h2>
        <ul style="color: #666; line-height: 2;">
            <li>‚úÖ Todos los <code>alert()</code> reemplazados: <strong>25 modales</strong></li>
            <li>‚úÖ Todos los <code>confirm()</code> reemplazados: <strong>2 confirmaciones</strong></li>
            <li>‚úÖ Sistema modal personalizado con 4 tipos</li>
            <li>‚úÖ Animaciones suaves y dise√±o moderno</li>
            <li>‚úÖ Soporte para confirmaciones con callback async</li>
        </ul>
    </div>
</div>

<!-- Modal de notificaciones -->
<div id="notificationModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-header">
            <div id="modalIcon" class="modal-icon"></div>
            <h3 id="modalTitle" class="modal-title"></h3>
        </div>
        <p id="modalMessage" class="modal-message"></p>
        <div id="modalFooter" class="modal-footer">
            <button id="modalBtnCancel" class="modal-btn modal-btn-secondary" onclick="cerrarModalNotificacion(false)" style="display: none;">Cancelar</button>
            <button id="modalBtnAccept" class="modal-btn modal-btn-primary" onclick="cerrarModalNotificacion(true)">Aceptar</button>
        </div>
    </div>
</div>

<script>
// Copiar el sistema de modales de dashboard-common.js
let modalCallback = null;

function mostrarNotificacion(mensaje, tipo = 'info', titulo = '') {
    const modal = document.getElementById('notificationModal');
    const icon = document.getElementById('modalIcon');
    const titleElement = document.getElementById('modalTitle');
    const messageElement = document.getElementById('modalMessage');
    const btnCancel = document.getElementById('modalBtnCancel');
    const btnAccept = document.getElementById('modalBtnAccept');
    
    const configuraciones = {
        success: { icono: '‚úì', titulo: titulo || '√âxito' },
        error: { icono: '‚úï', titulo: titulo || 'Error' },
        warning: { icono: '‚ö†', titulo: titulo || 'Advertencia' },
        info: { icono: '‚Ñπ', titulo: titulo || 'Informaci√≥n' }
    };
    
    const config = configuraciones[tipo] || configuraciones.info;
    
    icon.className = 'modal-icon';
    icon.classList.add(tipo);
    icon.textContent = config.icono;
    
    titleElement.textContent = config.titulo;
    messageElement.textContent = mensaje;
    
    btnCancel.style.display = 'none';
    btnAccept.textContent = 'Aceptar';
    
    modal.classList.add('show');
    modalCallback = null;
}

function mostrarConfirmacion(mensaje, titulo = 'Confirmar acci√≥n') {
    return new Promise((resolve) => {
        const modal = document.getElementById('notificationModal');
        const icon = document.getElementById('modalIcon');
        const titleElement = document.getElementById('modalTitle');
        const messageElement = document.getElementById('modalMessage');
        const btnCancel = document.getElementById('modalBtnCancel');
        const btnAccept = document.getElementById('modalBtnAccept');
        
        icon.className = 'modal-icon warning';
        icon.textContent = '?';
        
        titleElement.textContent = titulo;
        messageElement.textContent = mensaje;
        
        btnCancel.style.display = 'inline-block';
        btnAccept.textContent = 'Confirmar';
        
        modalCallback = resolve;
        modal.classList.add('show');
    });
}

function cerrarModalNotificacion(resultado = true) {
    const modal = document.getElementById('notificationModal');
    modal.classList.remove('show');
    
    if (modalCallback) {
        modalCallback(resultado);
        modalCallback = null;
    }
}

// Cerrar modal al hacer clic fuera
document.addEventListener('DOMContentLoaded', () => {
    const modal = document.getElementById('notificationModal');
    if (modal) {
        modal.addEventListener('click', (e) => {
            if (e.target === modal && !modalCallback) {
                cerrarModalNotificacion();
            }
        });
    }
});

// Funciones de prueba
function testSuccess() {
    mostrarNotificacion('El alumno se registr√≥ exitosamente en el sistema.', 'success');
}

function testError() {
    mostrarNotificacion('No se pudo conectar con el servidor. Verifique su conexi√≥n.', 'error');
}

function testWarning() {
    mostrarNotificacion('Por favor complete todos los campos antes de continuar.', 'warning');
}

function testInfo() {
    mostrarNotificacion('Los datos se est√°n procesando. Por favor espere un momento.', 'info');
}

async function testConfirm() {
    const confirmar = await mostrarConfirmacion(
        '¬øEst√° seguro de eliminar al alumno con c√©dula 1234567890?\n\nEsta acci√≥n no se puede deshacer.',
        'Confirmar eliminaci√≥n'
    );
    
    const resultDiv = document.getElementById('confirmResult');
    resultDiv.style.display = 'block';
    resultDiv.textContent = confirmar ? '‚úÖ Usuario confirm√≥ la eliminaci√≥n' : '‚ùå Usuario cancel√≥ la operaci√≥n';
    
    if (confirmar) {
        setTimeout(() => {
            mostrarNotificacion('El alumno se elimin√≥ correctamente.', 'success');
        }, 500);
    }
}

async function testConfirmCurso() {
    const confirmar = await mostrarConfirmacion(
        '¬øEst√° seguro de eliminar este curso?\n\nTodos los alumnos asociados quedar√°n sin curso.\nEsta acci√≥n no se puede deshacer.',
        'Confirmar eliminaci√≥n'
    );
    
    const resultDiv = document.getElementById('confirmResult');
    resultDiv.style.display = 'block';
    resultDiv.textContent = confirmar ? '‚úÖ Curso eliminado' : '‚ùå Operaci√≥n cancelada';
    
    if (confirmar) {
        setTimeout(() => {
            mostrarNotificacion('El curso se elimin√≥ correctamente.', 'success');
        }, 500);
    }
}

async function testOperacionCompleta() {
    mostrarNotificacion('Guardando los datos...', 'info');
    
    setTimeout(() => {
        mostrarNotificacion('Los datos del alumno se actualizaron correctamente.', 'success');
    }, 1500);
}

async function testOperacionError() {
    const confirmar = await mostrarConfirmacion(
        '¬øDesea continuar con esta operaci√≥n?\n\nEsta prueba mostrar√° un error simulado.',
        'Confirmar operaci√≥n'
    );
    
    if (confirmar) {
        setTimeout(() => {
            mostrarNotificacion('No se pudo guardar el alumno. Verifique los datos e intente nuevamente.', 'error');
        }, 800);
    }
}
</script>

</body>
</html>
